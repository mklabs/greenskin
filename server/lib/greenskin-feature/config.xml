<?xml version="1.0" encoding="UTF-8"?><project>
  <actions/>
  <description>Testing out browsertime metrics</description>
  <logRotator class="hudson.tasks.LogRotator">
    <daysToKeep>-1</daysToKeep>
    <numToKeep>20</numToKeep>
    <artifactDaysToKeep>-1</artifactDaysToKeep>
    <artifactNumToKeep>-1</artifactNumToKeep>
  </logRotator>
  <keepDependencies>false</keepDependencies>
  <properties>
    <hudson.model.ParametersDefinitionProperty>
      <parameterDefinitions>

        <hudson.model.StringParameterDefinition>
          <name>JSON_CONFIG</name>
          <description>JSON config.</description>
          <defaultValue><![CDATA[{"features":[{"name":"aze.feature","body":"Feature: example\n\n  Scenario: Browsing http://phantomjs.org/\n    Given I browse URL \"http://phantomjs.org/\"\n    Then I want to collect navigation timings at \"timing.json\"\n\n\n  Scenario: Browsing example.com/n\n    Given I browse URL \"https://github.com/cucumber/cucumber/wiki/Gherkin\""}],"steps":[{"name":"stepfile.js","body":"Then(/I want to collect navigation timings at \"([^\"]+)\"/, function(filepath, done) {\n  var fs = require('fs');\n  var path = require('path');\n  var mkdirp = require('mkdirp');\n\n  this.driver.safeExecute(\"window.performance ? (window.performance.toJSON ? JSON.stringify(window.performance.toJSON()) : window.performance) : '{}'\", function(err, res) {\n\tif (err) return done(err);\n    mkdirp.sync(path.dirname(filepath));\n    fs.writeFileSync(filepath, JSON.stringify(res));\n    done();\n  });\n  \n});\n\n\nGiven(/I browse URL \"([^\"]+)\"/, function(url, done) {\n  var driver = this.driver;\n  driver.init(function() {\n    // driver#get should errback on invalid URL\n    driver.get(url, done);\n  });\n});\n\nThen(/I want to render the page at \"([^\"]+)\"/, function(filename, done) {\n  this.driver.saveScreenshot(filename, done);\n});\n\nThen(/I click on \"([^\"]+)\"/, function(selector, done) {\n  done();\n});\n\nThen(/I submit the form \"([^\"]+)\"/, function(selector, done) {\n  var driver = this.driver;\n  driver.elementByCssSelector(selector, function(err, element) {\n    if (err) return done(err);\n    element.submit(done);\n  });\n});\n\nThen(/I fill \"([^\"]+)\" in \"([^\"]+)\"/, function(value, name, done) {\n  var driver = this.driver;\n  driver.elementByCssSelector('[name=' + name + ']', function(err, element) {\n    if (err) return done(err);\n    driver.type(element, value, done);\n  });\n});\n"}]}]]></defaultValue>
        </hudson.model.StringParameterDefinition>

        <hudson.model.StringParameterDefinition>
          <name>DEBUG</name>
          <description>Log debug option</description>
          <defaultValue>*</defaultValue>
        </hudson.model.StringParameterDefinition>

      </parameterDefinitions>
    </hudson.model.ParametersDefinitionProperty>
  </properties>
  <scm class="hudson.scm.NullSCM"/>
  <assignedNode>master</assignedNode>
  <canRoam>false</canRoam>
  <disabled>false</disabled>
  <blockBuildWhenDownstreamBuilding>false</blockBuildWhenDownstreamBuilding>
  <blockBuildWhenUpstreamBuilding>false</blockBuildWhenUpstreamBuilding>
  <triggers>
    <hudson.triggers.TimerTrigger>
      <spec>*/5 * * * *</spec>
    </hudson.triggers.TimerTrigger>
  </triggers>
  <concurrentBuild>false</concurrentBuild>
  <builders>
    <hudson.tasks.Shell>
      <command># Download and install dependencies
[ -e node_modules ] || npm i gherkin-mocha mkdirp
mkdir -p tmp</command>
    </hudson.tasks.Shell>
    <hudson.tasks.Shell>
      <command>SAUCE_USERNAME=$(node -pe 'JSON.parse(process.env.JSON_CONFIG).sauce.username')
SAUCE_ACCESSKEY=$(node -pe 'JSON.parse(process.env.JSON_CONFIG).sauce.accesskey')
WD_HOSTNAME=$(node -pe 'var c = JSON.parse(process.env.JSON_CONFIG).sauce; c.username &amp;&amp; c.accesskey ? "ondemand.saucelabs.com" : "localhost"')
WD_PORT=$(node -pe 'var c = JSON.parse(process.env.JSON_CONFIG).sauce; c.username &amp;&amp; c.accesskey ? 80 : 9134')
WD_BROWSER=$(node -pe 'var c = JSON.parse(process.env.JSON_CONFIG).sauce; c.username &amp;&amp; c.accesskey ? (c.browser || "localhost") : "localhost"')

DEBUG=* ./node_modules/.bin/gherkin-mocha --webdriver-host $WD_HOSTNAME --webdriver-port $WD_PORT --webdriver-username $SAUCE_USERNAME --webdriver-accesskey $SAUCE_ACCESSKEY --webdriver-browser $WD_BROWSER</command>
    </hudson.tasks.Shell>
    <hudson.tasks.Shell>
      <command>rm -rf tmp</command>
    </hudson.tasks.Shell>

  </builders>
  <publishers>

  </publishers>
  <buildWrappers/>
</project>

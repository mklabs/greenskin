<!DOCTYPE html>
<!-- saved from url=(0045)http://codemirror.net/mode/gherkin/index.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>CodeMirror: Gherkin mode</title>
<meta charset="utf-8">
<link rel="stylesheet" href="http://codemirror.net/doc/docs.css">

<link rel="stylesheet" href="http://codemirror.net/lib/codemirror.css">
<link rel="stylesheet" href="http://codemirror.net/addon/hint/show-hint.css">
<script src="./CodeMirror  Gherkin mode_files/codemirror.js"></script>
<script src="./CodeMirror  Gherkin mode_files/gherkin.js"></script>
<script src="http://codemirror.net/addon/hint/show-hint.js"></script>
<script src="http://codemirror.net/addon/hint/xml-hint.js"></script>
<style>.CodeMirror { border-top: 1px solid #ddd; border-bottom: 1px solid #ddd; }</style>
</head><body><div id="nav">
  <a href="http://codemirror.net/"><img id="logo" src="./CodeMirror  Gherkin mode_files/logo.png"></a>

  <ul>
    <li><a href="http://codemirror.net/index.html">Home</a>
    </li><li><a href="http://codemirror.net/doc/manual.html">Manual</a>
    </li><li><a href="https://github.com/marijnh/codemirror">Code</a>
  </li></ul>
  <ul>
    <li><a href="http://codemirror.net/mode/index.html">Language modes</a>
    </li><li><a class="active" href="http://codemirror.net/mode/gherkin/index.html#">Gherkin</a>
  </li></ul>
</div>

<article>
<h2>Gherkin mode</h2>
<form><textarea id="code" name="code" style="display: none;">Feature: Using Google
  Background: 
    Something something
    Something else
  Scenario: Has a homepage
    When I navigate to the google home page
    Then the home page should contain the menu and the search form
  Scenario: Searching for a term 
    When I navigate to the google home page
    When I search for Tofu
    Then the search results page is displayed
    Then the search results page contains 10 individual search results
    Then the search results contain a link to the wikipedia tofu page
</textarea></form>
    <script>
      var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
        extraKeys: {
          "Ctrl-Space": function(cm) {
            CodeMirror.showHint(cm, function(cm, options) {
              window.cm = cm;
              console.log(cm, options);
              var cur = cm.getCursor(), token = cm.getTokenAt(cur);
              var inner = CodeMirror.innerMode(cm.getMode(), token.state);
              var line = cm.getLine(cur.line);
              var steps = { 'Given I browse': 1, 'Given I browse with cookies': 1, 'Then I click on': 1 };


              var pos = (line.match(/^\s*/) || [])[0];
              var start = pos ? pos.length : token.start;
              var word = token.string, end = token.end;
              // if (/[^\w$_-]/.test(word)) {
              //  word = ""; start = end = cur.ch;
              // }
              console.log('pos', pos, start);

              word = line.trim();

              var spec = CodeMirror.resolveMode("text/x-feature");

              var result = [];
              function add(keywords) {
                console.log(word, token, line, cur);
                for (var name in keywords)
                  if (!word || name.lastIndexOf(word, 0) == 0) {
                    result.push(name);
                  }
              }

              var st = token.state.state;
              add(steps);

              console.log(result);
              if (result.length) return {
                list: result,
                from: CodeMirror.Pos(cur.line, start),
                to: CodeMirror.Pos(cur.line, end)
              };

            }, {});
          }
        }
      });
    </script>

    <p><strong>MIME types defined:</strong> <code>text/x-feature</code>.</p>

  </article>
</body></html>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <title>Material Design Lite</title>

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.blue_grey-red.min.css" />

  <link rel="stylesheet" href="material.css">
</head>
<body class="greenskin">
  <div class="greenskin-layout mdl-layout mdl-js-layout mdl-layout--fixed-drawer mdl-layout--fixed-header">
    <header class="greenskin-header mdl-layout__header mdl-color--grey-100">

      <div class="mdl-layout__header-row">
        <div class="mdl-layout-spacer"></div>

        <nav class="mdl-navigation">
          <a class="mdl-navigation__link mdl-color-text--blue-grey-400" href="/">Home</a>
          <a class="mdl-navigation__link mdl-color-text--blue-grey-400" href="/list">Jobs list</a>
          <a class="mdl-navigation__link mdl-color-text--blue-grey-400" href="/create">Create a new Job</a>
          <a class="mdl-navigation__link mdl-color-text--blue-grey-400" href="/dashboard">Dashboard</a>
          <a class="mdl-navigation__link mdl-color-text--blue-grey-400" href="/">
            <i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">home</i>
            Home
          </a>
        </nav>
      </div>
    </header>

    <div class="greenskin-drawer mdl-layout__drawer mdl-color--blue-grey-900">
      <header class="greenskin-drawer-header">
        <h1 class="mdl-typography--title mdl-color-text--blue-grey-700">
          Agenda Dashboard
        </h1>

        <h2 id="active-title" class="mdl-typography--menu">
          <span class="active-job"></span>
          <small class="active-state"></small>
        </h2>
      </header>

      <nav class="greenskin-navigation mdl-navigation mdl-color--blue-grey-800">
        <div id="sidebar" class="al-sidebar">
          <div id="job-overview-list"></div>
        </div>
      </nav>
    </div>

    <main class="mdl-layout__content mdl-color--grey-100">
      <div class="mdl-grid greenskin-content">

        <div id="list-pane" class="mdl-cell mdl-cell--12-col">
          <table class="mdl-data-table mdl-js-data-table mdl-shadow--4dp is-upgraded">
            <thead>
              <tr>
                <th class="dl-data-table__cell--non-numeric">
                  Status
                </th>
                <th class="dl-data-table__cell--non-numeric">
                  Name
                </th>
                <th class="dl-data-table__cell--non-numeric">
                  Last run started
                </th>
                <th class="dl-data-table__cell--non-numeric">
                  Next run starts
                </th>
                <th class="dl-data-table__cell--non-numeric">
                  Last finished
                </th>
                <th class="dl-data-table__cell--non-numeric">
                  Locked
                </th>
              </tr>
            </thead>
            <tbody id="job-list"></tbody>
          </table>
        </div>

        <div id="details-pane" class="mdl-cell mdl-cell--12-col mdl-shadow--4dp mdl-card">
          <div class="panel-heading mdl-color--blue-grey-800 mdl-color-text--blue-grey-400">
            <h2 class="sub-header">
              <span class="number-selected">0</span> <small>selected</small>

              <button data-action="delete-jobs" class="pull-right mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
                Delete selected
              </button>
              <button data-action="requeue-jobs" class="pull-right mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
                Requeue selected
              </button>
            </h2>

          </div>

          <div id="details-list" class=""></div>

          <div id="create-job-pane" class="panel-body">
            <h2 class="sub-header">Create Job</h2>
            <hr />
            <div class="form-group">
              <label>Job name</label>
              <input type="text" class="job-name form-control">
            </div>
            <div class="form-group">
              <label>Schedule</label>
              <input type="text" class="job-schedule form-control">
            </div>
            <div class="form-group">
              <label>Repeat every</label>
              <input type="text" class="job-loop-every form-control">
            </div>
            <div class="form-group">
              <label>Job data (json)</label>
              <textarea class="job-data form-control">{}</textarea>
            </div>
            <div class="form-group">
              <span class="btn btn-default btn-success" data-action="save">Save</span>
              <span class="btn btn-default btn-warning" data-action="cancel">Cancel</span>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script type="text/template" id="overview-item-template">
    <nav class="mdl-navigation">
      <a class="mdl-navigation__link" href="#">
        <%- displayName %>
      </a>
    </nav>

    <ul class="mdl-list greenskin-navigation">
      <li data-state="scheduled" class="mdl-list__item mdl-navigation__link">
        <span class="mdl-list__item-primary-content">
          <i class="material-icons mdl-list__item-icon">schedule</i>
          Scheduled
        </span>
        <span class="mdl-list__item-secondary-content">
          <%= scheduled %>
        </span>
      </li>
      <li data-state="queued" class="mdl-list__item mdl-color-text--blue-grey-400 mdl-navigation__link">
        <span class="mdl-list__item-primary-content">
          <i class="material-icons mdl-list__item-icon">queue</i>
          Queued
        </span>
        <span class="mdl-list__item-secondary-content">
          <%- queued %>
        </span>
      </li>
      <li data-state="running" class="mdl-list__item mdl-color-text--blue-grey-400 mdl-navigation__link">
        <span class="mdl-list__item-primary-content">
          <i class="material-icons mdl-list__item-icon">refresh</i>
          Running
        </span>
        <span class="mdl-list__item-secondary-content">
          <%- running %>
        </span>
      </li>
      <li data-state="completed" class="mdl-list__item mdl-color-text--blue-grey-400 mdl-navigation__link">
        <span class="mdl-list__item-primary-content">
          <i class="material-icons mdl-list__item-icon">done</i>
          Completed
        </span>
        <span class="mdl-list__item-secondary-content">
          <%- completed %>
        </span>
      </li>
      <li data-state="failed" class="mdl-list__item mdl-color-text--blue-grey-400 mdl-navigation__link">
        <span class="mdl-list__item-primary-content">
          <i class="material-icons mdl-list__item-icon">sms failed</i>
          Failed
        </span>
        <span class="mdl-list__item-secondary-content">
          <%- failed %>
        </span>
      </li>
      <li data-state="repeating" class="mdl-list__item mdl-color-text--blue-grey-400 mdl-navigation__link">
        <span class="mdl-list__item-primary-content">
          <i class="material-icons mdl-list__item-icon">repeat</i>
          Repeating
        </span>
        <span class="mdl-list__item-secondary-content">
          <%- repeating %>
        </span>
      </li>
    </ul>
  </script>

  <script type="text/template" id="job-item-template">
    <td>
      <% if (repeating) { %><span class="label label-info"><i class="ion-loop"></i> <%- job.repeatInterval %></span><% } %>
      <% if (scheduled) { %><span class="label label-info">Scheduled</span><% } %>
      <% if (queued) { %><span class="label label-primary">Queued</span><% } %>
      <% if (running) { %><span class="label label-warning">Running</span><% } %>
      <% if (completed) { %><span class="label label-success">Completed</span><% } %>
      <% if (failed) { %><span class="label label-danger">Failed</span><% } %>
    </td>
    <td>
      <%- job.name %>
    </td>
    <td><% if (job.lastRunAt) { %><time datetime="<%- moment(job.lastRunAt).toISOString() %>"><%- moment(job.lastRunAt).fromNow() %></time><% } %></td>
    <td><% if (job.nextRunAt) { %><time datetime="<%- moment(job.nextRunAt).toISOString() %>"><%- moment(job.nextRunAt).fromNow() %></time><% } %></td>
    <td><% if (job.lastFinishedAt) { %><time datetime="<%- moment(job.lastFinishedAt).toISOString() %>"><%- moment(job.lastFinishedAt).fromNow() %></time><% } %></td>
    <td><% if (job.lockedAt) { %><time datetime="<%- moment(job.lockedAt).toISOString() %>"><%- moment(job.lockedAt).fromNow() %></time><% } %></td>
  </script>

  <script type="text/template" id="job-item-details-template">
    <div class="panel-body">
      <div>
        <button class="close pull-right mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect">
          <i class="material-icons">close</i>
        </button>

        <h3><%- job.name %></h3>
        <% if (repeating) { %><span class="label label-info"><i class="ion-loop"></i> <%- job.repeatInterval %></span><% } %>
        <% if (scheduled) { %><span class="label label-info">Scheduled</span><% } %>
        <% if (queued) { %><span class="label label-primary">Queued</span><% } %>
        <% if (running) { %><span class="label label-warning">Running</span><% } %>
        <% if (completed) { %><span class="label label-success">Completed</span><% } %>
        <% if (failed) { %><span class="label label-danger">Failed</span><% } %>
      </div>
      <div>
        <% if (job.lastRunAt) { %><p>Last run <time datetime="<%- moment(job.lastRunAt).toISOString() %>"><%- moment(job.lastRunAt).fromNow() %></time></p><% } %>
        <% if (job.nextRunAt) { %><p>Next run <time datetime="<%- moment(job.nextRunAt).toISOString() %>"><%- moment(job.nextRunAt).fromNow() %></time></p><% } %>
        <% if (job.lastFinishedAt) { %><p>Last finished <time datetime="<%- moment(job.lastFinishedAt).toISOString() %>"><%- moment(job.lastFinishedAt).fromNow() %></time></p><% } %>
        <% if (job.lockedAt) { %><p>Locked <time datetime="<%- moment(job.lockedAt).toISOString() %>"><%- moment(job.lockedAt).fromNow() %></time></p><% } %>
        <% if (job.repeatInterval) { %><p>Repeat each <%- job.repeatInterval %></p><% } %>

        <h4>Job data</h4>
        <pre class="mdl-shadow--4dp mdl-color--blue-grey-100"><%- JSON.stringify(job.data, null, 2) %></pre>
        <% if (failed) { %>
          <strong>Failure reason</strong>
          <pre><%- JSON.stringify(job.failReason || '', null, 2) %></pre>
        <% } %>
      </div>
    </div>

    <div class="panel-footer clearfix mdl-color--blue-grey-800 mdl-color-text--blue-grey-400">
      <button data-action="requeue" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
        Requeue
      </button>
      <button data-action="delete" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
        Delete permanently
      </button>
    </div>
  </script>

  <script src="https://code.getmdl.io/1.1.3/material.min.js"></script>
  <script src="https://code.jquery.com/jquery-2.2.3.min.js" integrity="sha256-a23g1Nt4dtEYOj7bR+vTu7+T8VP13humZFBJNIYoEJo=" crossorigin="anonymous"></script>
  <script src="/scripts/lodash.min.js"></script>
  <script src="/scripts/backbone-min.js"></script>
  <script src="/scripts/moment.min.js"></script>
  <script src="/scripts/main.js"></script>

</body>
</html>

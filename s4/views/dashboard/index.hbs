{{#extend "scripts"}}
<script src="/js/pages/dashboard.js"></script>
{{/extend}}

<div class="page-header clearfix" style="margin-top: 0;">
  <h3>
    Dashboard
  </h3>

  <div class="btn-group right">
    <a href="/dashboard/admin" class="btn btn-default">
      Admin
    </a>
  </div>
</div>

<div class="js-dashboard-wrapper">
  <table class="table js-dashboard">
    <thead>
      <tr>
        <th></th>
        <th>Name</th>
        <th>Type</th>
        <th>Last Success</th>
        <th>Last Failure</th>
        <th>Perf avg</th>
        <th>Number of failed builds</th>
        <th>Number of failed asserts</th>
        <th>Availability</th>
      </tr>
    </thead>
    <tbody>
      {{#jobs}}
      {{#data.selected}}
      <tr class="{{#red}}warning{{/red}}">
        <td>
          <a href="/{{ namespace }}/{{ name }}/{{ lastBuild.number }}">
            <div class="doony-circle doony-circle-{{ color }}{{#animated}} bounceIn animated infinite{{/animated}}" style="display: inline-block; margin-top: 4px; margin-left: 4px; width: 24px; height: 24px;"></div>
          </a>
        </td>
        <td>
          <a href="/{{ namespace }}/{{ name }}/">{{ name }}</a>
          <a href="{{ url }}">(jenkins)</a>
        </td>
        <td>
          <a href="/{{ namespace }}/{{ name }}/edit/" class="label label-default">
          {{ type }}
          </a>
        </td>
        <td>
          <a href="/{{ namespace }}/{{ name }}/{{ lastSuccessfulBuild.number }}">
          {{ lastSuccessfulBuild.moment }}
          </a>
        </td>
        <td>
          <a href="/{{ namespace }}/{{ name }}/{{ lastFailedBuild.number }}">
          {{ lastFailedBuild.moment }}
          </a>
        </td>
        <td>
          <span class="label label-{{ data.loadTimeColor }}">
            {{ data.perfAvg }}ms
          </span>

          <span class="glyphicon glyphicon-arrow-{{ data.loadTimeArrow }}"></span> (Assert: {{data.assertLoadTime}})
        </td>
        <td>
          {{ data.numberOfFailedBuilds }}
        </td>
        <td>
          {{ data.numberOfFailedAsserts }}
        </td>
        <td>

          <span class="label label-{{ data.availabilityColor }}">
            {{ data.availability }}%
          </span>

          <span class="glyphicon glyphicon-arrow-{{ data.availabilityArrow }}"></span> (Avg: {{data.availabilityAvg}})
        </td>
      </tr>
      {{/data.selected}}
      {{/jobs}}
    </tbody>
  </table>
</div>

